# Electricity Price Forecasting Notebooks

This directory contains Google Colab notebooks implementing the hybrid spatial-temporal electricity price forecasting model. The notebooks should be executed in the sequence outlined below.

## Notebook Sequence

1. **1_eda.ipynb**: Exploratory Data Analysis
   - Explores raw electricity price data from the New Zealand market
   - Analyzes price distributions, temporal patterns, and volatility
   - Identifies market characteristics and price anomalies
   - Link: [Google Colab](https://colab.research.google.com/drive/1id5WP6gZgAipPrvEMaQow_sXiSnFXKXw)

2. **2_preprocessing.ipynb**: Data Preprocessing
   - Cleans and transforms raw data
   - Handles missing values and outliers
   - Creates temporal features (rolling statistics, lag variables)
   - Outputs processed datasets for modeling
   - Link: [Google Colab](https://colab.research.google.com/drive/1tWlCnCovujRVCOLGuitaiwzocoNu4Hrk)

3. **3_dtw.ipynb**: Dynamic Time Warping
   - Computes pairwise DTW distances between Points of Connection (POCs)
   - Converts distance matrix to similarity using Gaussian kernel
   - Creates adjacency matrix for graph modeling
   - Link: [Google Colab](https://colab.research.google.com/drive/10_jVLxxvGZsvY9K3R0dO__DMS7paus_N)

4. **4_tft.ipynb**: Temporal Fusion Transformer
   - Implements TFT model for temporal forecasting
   - Trains model on preprocessed data
   - Evaluates performance with attention visualization
   - Link: [Google Colab](https://colab.research.google.com/drive/1g3zcN_hJ1NHwiVYTZIB_LB41Pw65tzkb)

5. **5_gat.ipynb**: Graph Attention Network
   - Implements GAT model for spatial relationship modeling
   - Leverages DTW-based adjacency matrix
   - Provides node embedding visualization
   - Link: [Google Colab](https://colab.research.google.com/drive/1YLn2KRSFi3wNwIJcoVFwl_n2ZUsXmVdK)

6. **6_hybrid.ipynb**: Hybrid TFT-GAT Model
   - Combines temporal and spatial components
   - Integrates TFT and GAT into unified architecture
   - Evaluates combined model performance
   - Link: [Google Colab](https://colab.research.google.com/drive/1YuoDryvxMACkR5TMPfb1CMwSbx8V6jDx)

## Running the Notebooks

### Prerequisites
- Google account with access to Google Drive
- Access to Google Colab
- Sufficient Drive storage space for datasets (~2GB recommended)

### Setup Instructions

1. Create the necessary folder structure in Google Drive:
   ```
   MyDrive/
   └── WattGrid/
       ├── data/
       │   ├── raw/             # Raw CSV files
       │   └── processed/       # Will store processed data
       └── results/
           ├── models/          # Will store trained models
           └── plots/           # Will store visualizations
   ```

2. Upload raw electricity price data to `WattGrid/data/raw/`

3. Follow these steps for each notebook:
   - Open the notebook using the provided Google Colab link
   - Set runtime type to GPU (Runtime > Change runtime type > Hardware accelerator: GPU)
   - Run the cell to mount Google Drive
   - Execute remaining cells in sequence

### Execution Notes

- **Memory Management**: The code includes parameters to adjust sample sizes if needed. For full datasets, you may need Google Colab Pro.
- **Runtime Duration**: Notebooks 4, 5, and 6 involve model training and may take several hours to complete.
- **Dependencies**: Each notebook includes all necessary package installations.
- **Data Persistence**: All outputs are saved to Google Drive and will persist between Colab sessions.

## Large File Handling

Note that some generated files, particularly in `data/processed/` may exceed GitHub's file size limits:
- `cleaned_data.csv` (~100 MB)
- `featured_data.csv` (~1.6 GB)

These files are excluded from Git tracking and should be regenerated by running the preprocessing notebook. Alternatively, they can be downloaded from [here](https://drive.google.com/drive/folders/1GgSX5nYtxqsZ4l_VwCbjYTzLSmbDSUD1).

## Troubleshooting

- **Session Disconnects**: For long-running cells, enable "Settings > Miscellaneous > Receive notification when execution completes"
- **Memory Errors**: Reduce batch size or sample size parameters in the code
- **Drive Mount Failures**: Ensure you have sufficient permissions and try re-authenticating
- **Package Conflicts**: Restart runtime after installing packages
